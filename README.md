# Effective HomeWork: Banking Service

> Приложение для демонстрации возможностей сервиса "Банковских операций". Хотите открыть свой банк? Без проблем, мы
> покажем как он может работать и какие возможности у него могут быть:).
>
>
> # Ссылка на ТЗ
> - [Link HW](https://github.com/Jon7even/java-banking-service/tree/main/docs/tasks/technical-task.md)


> [!IMPORTANT]
> Создано с помощью:
> - Java 17
> - Spring Boot 3
> - PostgreSQL
> - Liquibase
> - Maven
> - REST API
> - Lombok
> - Mapstruct
> - JUnit 5
> - TestContainers
> - MockMVC
> - AssertJ
> - Docker
> - Postman

> [!NOTE]
> Что это? Это демонстрационное REST API приложение для банковских операций. Использует классическую архитектуру.
> Контейнер c Main Service: [<->Controller -> Service -> Repository<->]
> Контейнер с Базой данных: [<->PostgreSQL]
> Общение между контейнерами происходит по локальной сети с помощью специальной настройки в Docker-compose

## Архитектура приложения

![Архитектура приложения на схеме](/docs/images/architecture.jpg?style=center)

## Диаграмма взаимодействия в БД

![Диаграмма БД](/docs/images/diagram.png?style=center)

> [!TIP]
> Что можно улучшить:
> - Добавить Gateway(шлюз)
> - Добавить брокер сообщений (RabbitMQ/Kafka)
> - Добавить кеш на NOSQL БД
> - Настроить сохранение логов в файл и их чистку

## Сборка и запуск

### Обязательное наличие на запускаемой машине:

- Java 17
- Docker version 24.0.5
- Docker Compose version v2.20
- Postman

### Действия для запуска:

- Переименовываем файл переменных окружения `.env.Default` в `.env`(если требуется, внесите изменения)
- Запустить Docker engine
- Находясь в главном каталоге с помощью Maven собрать проект `mvn clean install`
  Проект соберется и запустятся автоматические тесты. Обратите внимание, в тестах используются тест-контейнеры.
  Именно поэтому нужно запустить докер перед выполнением тестов, сначала загрузятся необходимые образы, затем по
  очереди будут запускаться контейнеры. После того как тесты отработают, контейнеры для тестов сами деактивируется,
  но сами образы останутся, их можно удалить.
- Если есть потребность и не хочется ждать, можно собрать проект без тестов, используя специальный подготовленный
  `maven` профиль для этого, действия почти те же:
  Находясь в главном каталоге с помощью Maven собрать проект `mvn clean install -Pno-tests-bs`
- Далее, в главном каталоге командой `docker-compose up -d` компилируем образы для контейнеров. Соберется образ СУБД
  PostgreSQL и образ с нашим собранным Spring Boot приложением(обязательно должно быть скомпилировано до запуска).
- После всех проделанных выше действий есть 2 варианта проверить работу проекта:
- 1). С помощью любого REST клиента сделать запросы на эндпоинты (встроенный в IDEA, Insomnia, Postman и т.д.)
- 2). Запустить установленный Postman и импортировать в него готовые тесты, которые находятся в папке
  [postman](/docs/postman/)
  Важно! Тесты в postman нужно запускать на чистой БД, которая только создалась. Если в нее что-то добавить,
  то логика работы тестов может поломаться. После отработки, можно с помощью любого клиента подключиться к
  Postgre БД и проверить наполнение данными, данные для подключения ниже, пароль можно посмотреть в файле .env:

![Подключение к БД через DBeaver](/docs/images/connection_bd_external.png?style=center)

img[src$="center"] {
display:block;
margin: 0 auto;
}